# Методология сборки

## Понятие сборки

При работе с большими сайтами, как правило, сложно следить за кодом всего проекта и производить его рефакторинг. Многие разработчики предпочитают разбивать сайт на множество маленьких взаимосвязанных файлов, с которыми удобно работать (читайте подробнее [о файловой системе сайта]()). Однако исходный проект, с которым работает человек, не подходит для выкладки на сервер: браузер будет обрабатывать такой сайт неоправданно медленно, а число запросов на сервер возрастет.

Для решения проблемы готовый проект **собирают**, трансформируя файловую структуру сайта и оптимизируя код страниц.

![Код для людей в код для роботов](https://img-fotki.yandex.ru/get/16165/158800653.0/0_111c55_72635305_orig)

Собирать можно как сайт целиком, так и отдельные страницы (или даже фрагменты страниц).

## Инструменты сборки

Чтобы автоматически собрать сайт, используют специальные инструменты сборки. Вы можете написать уникальный инструмент для своего проекта или использовать один из уже существующих. К примеру,

* [Gulp](http://gulpjs.com/)
* [Grunt](http://gruntjs.com/)
* [Brunch](http://brunch.io/)
* [Broccoli](https://www.npmjs.org/package/broccoli)
* [ENB](http://enb-make.info/)

**На вход** сборщик получает сайт с абстрактной файловой структурой и множеством разрозненных файлов.

**В процессе** сборщик, на основании конфигурационного файла и собственных алгоритмов:

* объединяет раздробленные маленькие файлы в цельные, по предназначению
* задействует нужные шаблоны
* подключает сущности из библиотек согласно зависимостям
* оптимизирует код (например, раскрывает `import` в CSS)
* удаляет служебные знаки (например, отступы и пробелы) и т.д.

**На выход** сборщик выдает компактный набор папок и файлов, занимающий наименьшее место на сервере и максимально быстро обрабатываемый браузером.

TODO: Схема с импортами в CSS с описанием

## Повторная сборка

Обычно, после внесения изменений в проект и перед выкладкой на сервер, его пересобирают. При этом необходимо вручную отслеживать, какие части проекта были добавлены или удалены. Упростить задачу поможет использование понятия **декларации** страницы - упорядоченного списка всех составляющих страницы, на основании которого она последовательно собирается (читайте подробнее о понятии [декларации в БЭМ-методологии]()).

Случается, что перед повторной сборкой разработчик хочет переопределить вид некоторых компонентов сайта, не затрагивая код имеющихся библиотек. Например, для того, чтобы представить блок по-разному на мобильных и десктопных устройствах. В БЭМ-методологии применяется понятие [уровней переопределения](), которые решают проблему повторного использования кода.

Существуют [готовые решения]() для сборки БЭМ-проектов.
